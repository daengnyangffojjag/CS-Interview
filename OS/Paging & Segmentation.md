### Paging & Segmentation

---

**가상 메모리**를 관리하기 위한 방법

- 프로세스 주소 공간을 논리적인 단위로 분리
- 물리적인 메모리와 매핑하는 방식으로 메모리를 관리

### Paging

---

프로세스 주소 공간을 **동일한 크기**의 블록인 **페이지**로 분할하여 메모리에 할당하는 방식

- 프로세스 주소 공간은 페이지로, 물리적인(실제) 메모리는 동일한 크기의 블록인 **페이지 프레임**으로 분할
- 운영체제는 **페이지 테이블**을 사용하여 페이지와 페이지 프레임 간의 대응관계를 유지

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e5c15fa3-0fe6-419b-a3fb-264f5caa9985/Untitled.png)

- 페이지와 페이지 프레임은 보통 크기가 같음
- 페이지 테이블을 이용해 논리주소에서 프레임을 가르키는 물리주소로 매핑

### Page Table

가상 메모리에서 가상 주소를 물리 주소로 변환하기 위해 사용하는 데이터 구조

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/608186b0-82af-438a-87a8-681df277cce2/Untitled.png)

- 각 페이지에 대한 매핑 정보를 가짐
- 메인 메모리에 저장되어 있음
- 가상 주소를 인덱스로 사용하여 해당 페이지에 대한 매핑 정보를 찾음
- 배열 구조로 인덱스가 페이지 번호를 가르키고 배열에 담긴 숫자가 매핑할 프레임 번호를 가르킴

### 페이징 할당 과정

1. 페이지 테이블 생성 및 초기화
2. 프로세스가 페이지 생성 및 사용 요청
    1. 프로세스는 페이지 번호와 필요한 크기를 제공
3. 운영체제는 메모리 확인 후 프로세스에 할당할 메모리 공간을 찾음
4. 할당할 메모리 공간을 페이지 단위로 분할
5. 페이지 테이블에 가상 주소와 물리 주소 기록
6. 프로세스는 페이지 번호를 사용하여 메모리에 접근

### 페이징을 사용하는 이유

<aside>
💡 외부 단편화?

</aside>

프로세스가 메모리에 할당되고 해제되는 과정에서 작은 조각들이 남아서 메모리 공간이 조각화되는 현상

- 충분한 크기의 메모리 공간이 있음에도 조각화되어 연속적으로 할당 할 수 없는 상황
- 메모리 공간의 낭비

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/8af4c07f-e836-45dd-ac1f-54f4d6a7a610/Untitled.png)

1. **외부 단편화** 해결
- 페이징은 물리 메모리를 고정된 크기의 페이지로 분할하여 할당
- 프로세스 주소공간을 페이지 단위로 분할
- 페이지의 고정된 크기는 할당된 페이지 크기 만큼의 물리 메모리를 찾아 프로세스를 할당 할 수 있게 함
1. 메모리 관리의 효율성
- 가상 메모리 관리의 효율성을 향상
- 물리 메모리의 크기에 제약받지 않고 더 많은 프로세스를 실행 가능

### 페이징의 단점

<aside>
💡 내부 단편화?

</aside>

프로세스의 메모리 관리에서 발생하는 현상으로 할당된 메모리 영역이 프로세스의 실제 크기보다 큰 경우

- 메모리의 작은 조각들이 쌓여나갈 때, 실제론 충분한 공간이 있음에도 프로세스를 할당할 수 없음
- 메모리 공간의 낭비
- 페이지 단위를 작게하면 해결할 수 있지만, 페이징 매핑 과정이 복잡해져 비효율적임

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/4b552f0e-3c36-45f0-8d79-3532d6abd21d/Untitled.png)

### 예상질문

1. 페이징에 대해서 설명해주세요

페이징은 가상 메모리를 관리하기 위한 방법으로 동일한 크기의 블록인 페이지로 메모리를 분할하여 논리 주소와 물리적인 주소를 매핑하는 방식입니다.

1. 페이지 테이블의 역할에 대해서 설명해주세요

페이지 테이블은 가상 주소와 물리 주소 간의 매핑 정보를 저장하는 데이터 구조 입니다. 배열 구조의 페이지 테이블은 인덱스가 페이지 번호를 가르키고 배열에 담긴 숫자가 매핑할 프레임 번호를 가르킵니다. 따라서 페이지 테이블을 통해 해당 페이지의 물리 주소를 확인하여 메모리에 접근할 수 있습니다.

1. 페이징의 장단점을 설명해주세요

장점으론 페이징은 고정된 동일한 크기의 페이지로 메모리를 관리하기 때문에 프로세스는 페이지 단위로 메모리에 할당됩니다. 따라서 메모리 내의 공간이 조각화 되는 외부 단편화 문제가 생기지 않습니다. 하지만 단점으론 고정된 동일한 크기의 페이지로 메모리를 분할하여 할당하는 것은 할당된 메모리 영역이 프로세스보다 커서 발생하는 내부 단편화 문제가 생길 수 있습니다.

### Segmentation

> 프로세스 주소 공간을 **서로 크기가 다른** 논리적인 블록인 **세그먼트 단위**로 분할하는 방법
> 

<aside>
💡 세그먼트?

</aside>

가상메모리에서 코드, 데이터, 스택 등과 같이 논리적으로 관련된 정보의 블록을 나타내는 단위

- 프로세스 주소 공간을 구성하는 논리적인 단위
- 각각의 세그먼트는 고유의 크기와 속성을 지님
    - 메인 프로그램, function, object, method 등
    - 코드 세그먼트, 데이터 세그먼트, 스택 세그먼트 등

---

**Segmentation**

- 논리적 단위로 나뉘기 때문에 미리 분할하지 않고 메모리를 사용할 시점에 할당
- 운영체제는 **세그먼트 테이블**을 사용해 세그먼트와 세그먼트 프레임 간의 대응관계를 유지

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e24ad374-bc5f-4be4-aa0b-359b9da367c9/Untitled.png)

### Segment Table

가상 메모리에서 가상 주소를 물리 주소로 변환하기 위해 사용하는 데이터 구조

- 주로 배열이나 해시 테이블로 구현
- 페이지 테이블과 거의 비슷하나 **세그먼트의 길이(Limit)**을 가짐

### 세그먼테이션을 사용하는 이유

1. **내부 단편화** 해결
- 세그먼트 크기를 실제 크기에 가깝게 조정하여 내부 단편화를 줄일 수 있음
1. **논리적 구조 표현**
- 프로세스 주소 공간을 논리적인 단위로 분할
- 코드, 데이터, 스택과 같은 관련된 정보들이 각각의 세그먼트로 구분되어 관리
1. **모듈화 및 재사용성**
- 각각의 세그먼트는 프로세스 내에서 독립적인 기능을 하거나 데이터를 포함
- 각각의 세그먼트를 독립적으로 개발하거나 재사용
1. **메모리 할당의 유연성**
- 각 세그먼트는 고유한 크기와 속성을 지님
- 필요한 만큼의 메모리 공간을 할당받음

### 세그먼트의 단점

1. 외부 단편화
- 프로세스 주소 공간을 세그먼트로 분할하여 메모리에 할당
- 이 과정에서 메모리에 세그먼트들이 쪼개져 할당되어 외부 단편화 발생
1. 세그먼트 크기의 가변성
- 세그먼트의 크기가 변경되는 경우에 메모리 공간을 조정하고 재배치 해야 하는 문제

### 예상질문

1. 세그멘테이션에 대해서 설명해주세요

세그멘테이션은 가상 메모리를 관리하기 위한 방법으로 논리적인 블록인 세그먼트로 메모리를 분할하여 논리 주소와 물리적인 주소를 매핑하는 방식입니다.

1. 세그멘테이션을 사용했을 때 이점에 대해서 설명해주세요

세그먼테이션은 논리적인 단위인 세그먼트로 분할하기 때문에 프로그램의 구조를 유연하게 표현할 수 있고 프로세스의 크기와 요구 사항에 따라 세그먼트는 다양한 크기를 가질 수 있습니다. 이로 인해 내부 단편화를 최소화 할 수 있습니다. 

1. 세그멘테이션의 단점에 대해서 설명해주세요

세그멘테이션은 프로세스를 세그먼트 단위로 분할하여 메모리에 할당하는데 이로 인해 외부 단편화가 생겨 메모리 공간의 이용하는데 효율성을 저하시킬 수 있습니다. 또 세그먼트의 크기가 변경되는 경우 메모리 공간을 조정하고 재배치 해야하는 문제도 있습니다.

[[운영체제] 페이징과 세그멘테이션](https://steady-coding.tistory.com/524)

[[운영체제] 페이징(Paging)이란? 페이지 테이블이란?](https://code-lab1.tistory.com/55)

[운영체제 ] 내부단편화, 외부단편화란](https://m.blog.naver.com/rbdi3222/220623825770)

[[운영체제 정리] 15: 세그멘테이션 (Segmentation) | 완숙의 에그머니🍳](https://wansook0316.github.io/cs/os/2020/04/06/운영체제-정리-15-세그멘테이션.html)
